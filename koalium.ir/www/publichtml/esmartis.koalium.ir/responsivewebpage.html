<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Enterprise Smart Home Dashboard</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
  <style>
    /* Custom responsive styles */
    #status { font-size: 1.2rem; }
    .btn { margin-top: 10px; }
  </style>
</head>
<body>
  <div class="container mt-3">
    <h1>Smart Home Dashboard</h1>
    <p>Welcome, {{ auth()->user()->name }}</p>
    
    <!-- Social Login (if not already authenticated) -->
    @guest
      <a href="{{ route('social.redirect', ['provider' => 'google']) }}" class="btn btn-danger">Login with Google</a>
      <a href="{{ route('social.redirect', ['provider' => 'facebook']) }}" class="btn btn-primary">Login with Facebook</a>
      <a href="{{ route('social.redirect', ['provider' => 'apple']) }}" class="btn btn-dark">Login with Apple</a>
    @endguest
    
    <div id="status" class="mt-4">
      <!-- Real-time status updates appear here -->
    </div>
    <button class="btn btn-warning" onclick="sendCommand('toggleDoor')">Toggle Door Lock</button>
    <button class="btn btn-info" onclick="sendCommand('adjustAmbient')">Adjust Ambient Control</button>
  </div>

  <!-- WebSocket and real-time updates -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://js.pusher.com/7.0/pusher.min.js"></script>
  <script>
    // Setup WebSocket connection using Pusher or Laravel Echo
    // For example, using Pusher:
    const pusher = new Pusher('YOUR_PUSHER_APP_KEY', {
      cluster: 'YOUR_CLUSTER'
    });
    const channel = pusher.subscribe('device-updates');
    channel.bind('App\\Events\\DeviceStatusUpdated', function(data) {
      document.getElementById("status").innerHTML = 
        "Temperature: " + data.temperature + " Â°C, " +
        "Humidity: " + data.humidity + "%, " +
        "Door Locked: " + (data.doorLocked ? "Yes" : "No");
    });

    // Command function to send control commands via API
    function sendCommand(cmd) {
      axios.post('/device/command', { command: cmd })
        .then(response => alert(response.data.message))
        .catch(error => console.error(error));
    }
  </script>
</body>
</html>
